using System;
using System.Diagnostics;
using System.IO;

class Launcher
{
    static int Main(string[] args)
    {
        // Път до вашия JAR файл
        string jarPath = Path.Combine(d:\JavaProjectEclipce\WBC_DBase2\WBC_DBase, "WBC_DBase.jar");

        // Проверка дали JAR файлът съществува
        if (!File.Exists(jarPath))
        {
            Console.Error.WriteLine("JAR файлът не е намерен: " + jarPath);
            return 1;
        }

        // Проверка за наличен Java interpreter
        // Опционално: опитваме да намерим java чрез системния PATH
        string javaExe = "java";
        if (!IsJavaAvailable(javaExe))
        {
            // Опитайте път до JRE/JDK, ако знаете конкретен
            Console.Error.WriteLine("Java не е намерена в PATH. Опитайте да посочите конкретен път до java.");
            return 2;
        }

        // Стартиране на: java -jar yourapp.jar
        var startInfo = new ProcessStartInfo
        {
            FileName = javaExe,
            Arguments = $"-jar \"{jarPath}\"",
            UseShellExecute = false,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            CreateNoWindow = false
        };

        try
        {
            using (var proc = Process.Start(startInfo))
            {
                // По желание: прочитане на изхода/грешките
                string stdout = proc.StandardOutput.ReadToEnd();
                string stderr = proc.StandardError.ReadToEnd();

                proc.WaitForExit();

                Console.Write(stdout);
                if (!string.IsNullOrEmpty(stderr))
                    Console.Error.Write(stderr);

                return proc.ExitCode;
            }
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine("Грешка при стартиране: " + ex.Message);
            return 3;
        }
    }

    static bool IsJavaAvailable(string javaExe)
    {
        try
        {
            var psi = new ProcessStartInfo
            {
                FileName = javaExe,
                Arguments = "-version",
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using (var p = Process.Start(psi))
            {
                // При "-version" изходът обикновено е на StandardError
                p.WaitForExit(3000);
                // Ако кодът на изход е 0 или процесът е успешен, приемаме че Java е налична
                // По сигурно: проверяваме ExitCode
                return p.ExitCode == 0;
            }
        }
        catch
        {
            return false;
        }
    }
}